<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>V1 â€” Drawer Flow â€” Transport â†’ HÃ´tel â†’ Review & Options</title>
<link rel="stylesheet" href="v1-styles.css">
</head>
<body>

<!-- HEADER -->
<div class="header">
  <div class="header-left">
    <div class="header-destination">Paris â†’ Lyon</div>
    <div class="header-pills">
      <span class="header-pill">16 â€“ 23 jan.</span>
      <span class="header-pill">3 voyageurs</span>
    </div>
  </div>
  <div class="wf-stepper" id="stepper">
    <div class="wf-step done" id="st-search" onclick="goToStep('transport')">
      <div class="wf-step-circle"><svg width="12" height="12" viewBox="0 0 16 16" fill="none"><path d="M3 8.5L6.5 12L13 4" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg></div>
      <span class="wf-step-label">Recherche</span>
    </div>
    <div class="wf-line done"></div>
    <div class="wf-step active" id="st-transport">
      <div class="wf-step-circle">2</div>
      <span class="wf-step-label">Transport</span>
    </div>
    <div class="wf-line" id="wf-line-2"></div>
    <div class="wf-step" id="st-hotel">
      <div class="wf-step-circle">3</div>
      <span class="wf-step-label">HÃ´tel</span>
    </div>
    <div class="wf-line" id="wf-line-3"></div>
    <div class="wf-step" id="st-recap">
      <div class="wf-step-circle">4</div>
      <span class="wf-step-label">Review</span>
    </div>
    <div class="wf-line" id="wf-line-4"></div>
    <div class="wf-step" id="st-confirm">
      <div class="wf-step-circle">5</div>
      <span class="wf-step-label">Confirmation</span>
    </div>
    <span class="stepper-total" id="stepper-total"></span>
  </div>
</div>

<!-- MOBILE STEPPER -->
<div class="mobile-stepper" id="mobile-stepper">
  <div class="ms-label" id="ms-label">Ã‰tape 2/5 Â· Transport</div>
  <div class="ms-dots">
    <div class="ms-dot done"></div>
    <div class="ms-dot active" id="ms-dot-2"></div>
    <div class="ms-dot" id="ms-dot-3"></div>
    <div class="ms-dot" id="ms-dot-4"></div>
    <div class="ms-dot" id="ms-dot-5"></div>
  </div>
</div>


<div class="main">

  <!-- ================================================ -->
  <!-- STEP 1: TRANSPORT (flat scroll â€” no browse/detail)-->
  <!-- ================================================ -->
  <div class="step-content active" id="step-transport">
    <div class="step-inner">

      <!-- Hero (D-style) -->
      <div class="d-hero">
        <div class="d-hero-title">Choix du transport</div>
        <div class="d-hero-sub">Comparez <strong>trains</strong> et <strong>vols</strong> d'un seul coup d'oeil â€” Smart Routing activÃ©.</div>
      </div>

      <!-- ============================================ -->
      <!-- VIEW 1: RECO ZONE (default, visible)        -->
      <!-- ============================================ -->
      <div id="view-recos">
      <div class="d-reco-zone" id="d-reco-zone">
        <div class="d-reco-zone-header">
          <div>
            <div class="d-reco-zone-title">Votre transport</div>
            <div class="d-reco-zone-budget">Budget max : 160 â‚¬/pers</div>
          </div>
        </div>
        <div class="d-reco-zone-hint">SÃ©lectionnÃ©es selon votre <strong>politique entreprise</strong>, vos <strong>prÃ©fÃ©rences</strong> et votre <strong>historique</strong> de rÃ©servation.</div>
        <div class="d-reco-grid">
          <!-- Reco 1: TGV INOUI -->
          <div class="d-reco-card" data-id="train1" onclick="toggleRecoDetail('train1')">
            <div class="rc-header">
              <div class="rc-header-left">
                <div class="rc-icon train">ğŸš„</div>
                <div class="rc-price-block">
                  <div class="rc-price">290 â‚¬</div>
                  <div class="rc-price-pax">97 â‚¬ par passager</div>
                </div>
              </div>
              <span class="rc-tag rc-tag-info">RecommandÃ©</span>
            </div>
            <div class="rc-summary">
              <div class="rc-sum-line"><span class="rc-sum-label">TGV INOUI Â· 2nde</span></div>
              <div class="rc-sum-line"><span class="rc-sum-dir">A</span> 07:13 â†’ 09:13 <span class="rc-sum-dur">2h</span></div>
              <div class="rc-sum-line"><span class="rc-sum-dir">R</span> 18:00 â†’ 20:00 <span class="rc-sum-dur">2h</span></div>
            </div>
            <div class="rc-content">
              <!-- Leg 1: Aller -->
              <div class="rc-leg">
                <div class="rc-leg-meta">
                  <span class="rc-class">2nde</span>
                  <span class="rc-operator"><span class="rc-op-dot" style="background:#e3f2fd">ğŸš„</span> TGV INOUI</span>
                  <span class="rc-duration">2h Â· direct</span>
                </div>
                <div class="rc-route">
                  <div class="rc-time">07:13</div>
                  <div class="rc-track"><span class="rc-dot"></span><span class="rc-line"></span><span class="rc-dot"></span></div>
                  <div class="rc-time">09:13</div>
                </div>
                <div class="rc-stations">
                  <div class="rc-station"><div class="rc-station-name">Gare de Lyon</div><div class="rc-station-city">Paris</div></div>
                  <div class="rc-station rc-station-end"><div class="rc-station-name">Part-Dieu</div><div class="rc-station-city">Lyon</div></div>
                </div>
              </div>
              <!-- Leg 2: Retour -->
              <div class="rc-leg">
                <div class="rc-leg-meta">
                  <span class="rc-class">2nde</span>
                  <span class="rc-operator"><span class="rc-op-dot" style="background:#e3f2fd">ğŸš„</span> TGV INOUI</span>
                  <span class="rc-duration">2h Â· direct</span>
                </div>
                <div class="rc-route">
                  <div class="rc-time">18:00</div>
                  <div class="rc-track"><span class="rc-dot"></span><span class="rc-line"></span><span class="rc-dot"></span></div>
                  <div class="rc-time">20:00</div>
                </div>
                <div class="rc-stations">
                  <div class="rc-station"><div class="rc-station-name">Part-Dieu</div><div class="rc-station-city">Lyon</div></div>
                  <div class="rc-station rc-station-end"><div class="rc-station-name">Gare de Lyon</div><div class="rc-station-city">Paris</div></div>
                </div>
              </div>
            </div>
            <div class="rc-footer">
              <div class="rc-conditions">
                <span class="rc-cond rc-cond-yes">Modifiable avec frais</span>
                <span class="rc-cond rc-cond-no">Non remboursable</span>
              </div>

            </div>
          </div>
          <!-- Reco 2: Air France -->
          <div class="d-reco-card" data-id="flight1" onclick="toggleRecoDetail('flight1')">
            <div class="rc-header">
              <div class="rc-header-left">
                <div class="rc-icon flight">âœˆï¸</div>
                <div class="rc-price-block">
                  <div class="rc-price">378 â‚¬</div>
                  <div class="rc-price-pax">126 â‚¬ par passager</div>
                </div>
              </div>
              <span class="rc-tag rc-tag-fast">Plus rapide</span>
            </div>
            <div class="rc-summary">
              <div class="rc-sum-line"><span class="rc-sum-label">Air France Â· Economy Light</span></div>
              <div class="rc-sum-line"><span class="rc-sum-dir">A</span> 07:00 â†’ 08:10 <span class="rc-sum-dur">1h10</span></div>
              <div class="rc-sum-line"><span class="rc-sum-dir">R</span> 20:30 â†’ 21:40 <span class="rc-sum-dur">1h10</span></div>
            </div>
            <div class="rc-content">
              <!-- Leg 1: Aller -->
              <div class="rc-leg">
                <div class="rc-leg-meta">
                  <span class="rc-class">Economy</span>
                  <span class="rc-operator"><span class="rc-op-dot" style="background:#e8eaf6">âœˆï¸</span> Air France</span>
                  <span class="rc-duration">1h10 Â· direct</span>
                </div>
                <div class="rc-route">
                  <div class="rc-time">07:00</div>
                  <div class="rc-track"><span class="rc-dot"></span><span class="rc-line"></span><span class="rc-dot"></span></div>
                  <div class="rc-time">08:10</div>
                </div>
                <div class="rc-stations">
                  <div class="rc-station"><div class="rc-station-name">CDG</div><div class="rc-station-city">Paris</div></div>
                  <div class="rc-station rc-station-end"><div class="rc-station-name">LYS</div><div class="rc-station-city">Lyon</div></div>
                </div>
              </div>
              <!-- Leg 2: Retour -->
              <div class="rc-leg">
                <div class="rc-leg-meta">
                  <span class="rc-class">Economy</span>
                  <span class="rc-operator"><span class="rc-op-dot" style="background:#e8eaf6">âœˆï¸</span> Air France</span>
                  <span class="rc-duration">1h10 Â· direct</span>
                </div>
                <div class="rc-route">
                  <div class="rc-time">20:30</div>
                  <div class="rc-track"><span class="rc-dot"></span><span class="rc-line"></span><span class="rc-dot"></span></div>
                  <div class="rc-time">21:40</div>
                </div>
                <div class="rc-stations">
                  <div class="rc-station"><div class="rc-station-name">LYS</div><div class="rc-station-city">Lyon</div></div>
                  <div class="rc-station rc-station-end"><div class="rc-station-name">CDG</div><div class="rc-station-city">Paris</div></div>
                </div>
              </div>
            </div>
            <div class="rc-footer">
              <div class="rc-conditions">
                <span class="rc-cond rc-cond-yes">Modifiable avec frais</span>
                <span class="rc-cond rc-cond-no">Non remboursable</span>
                <span class="rc-cond rc-cond-neutral">ğŸ§³ 12kg</span>
              </div>

            </div>
          </div>
          <!-- Reco 3: OuiGo -->
          <div class="d-reco-card" data-id="train2" onclick="toggleRecoDetail('train2')">
            <div class="rc-header">
              <div class="rc-header-left">
                <div class="rc-icon train">ğŸš„</div>
                <div class="rc-price-block">
                  <div class="rc-price">196 â‚¬</div>
                  <div class="rc-price-pax">65 â‚¬ par passager</div>
                </div>
              </div>
              <span class="rc-tag rc-tag-success">Moins cher</span>
            </div>
            <div class="rc-summary">
              <div class="rc-sum-line"><span class="rc-sum-label">OuiGo Â· Standard</span></div>
              <div class="rc-sum-line"><span class="rc-sum-dir">A</span> 09:00 â†’ 11:30 <span class="rc-sum-dur">2h30</span></div>
              <div class="rc-sum-line"><span class="rc-sum-dir">R</span> 19:30 â†’ 22:00 <span class="rc-sum-dur">2h30</span></div>
            </div>
            <div class="rc-content">
              <!-- Leg 1: Aller -->
              <div class="rc-leg">
                <div class="rc-leg-meta">
                  <span class="rc-class">Standard</span>
                  <span class="rc-operator"><span class="rc-op-dot" style="background:#e8f5e9">ğŸš„</span> OuiGo</span>
                  <span class="rc-duration">2h30 Â· direct</span>
                </div>
                <div class="rc-route">
                  <div class="rc-time">09:00</div>
                  <div class="rc-track"><span class="rc-dot"></span><span class="rc-line"></span><span class="rc-dot"></span></div>
                  <div class="rc-time">11:30</div>
                </div>
                <div class="rc-stations">
                  <div class="rc-station"><div class="rc-station-name">Gare de Lyon</div><div class="rc-station-city">Paris</div></div>
                  <div class="rc-station rc-station-end"><div class="rc-station-name">Part-Dieu</div><div class="rc-station-city">Lyon</div></div>
                </div>
              </div>
              <!-- Leg 2: Retour -->
              <div class="rc-leg">
                <div class="rc-leg-meta">
                  <span class="rc-class">Standard</span>
                  <span class="rc-operator"><span class="rc-op-dot" style="background:#e8f5e9">ğŸš„</span> OuiGo</span>
                  <span class="rc-duration">2h30 Â· direct</span>
                </div>
                <div class="rc-route">
                  <div class="rc-time">19:30</div>
                  <div class="rc-track"><span class="rc-dot"></span><span class="rc-line"></span><span class="rc-dot"></span></div>
                  <div class="rc-time">22:00</div>
                </div>
                <div class="rc-stations">
                  <div class="rc-station"><div class="rc-station-name">Part-Dieu</div><div class="rc-station-city">Lyon</div></div>
                  <div class="rc-station rc-station-end"><div class="rc-station-name">Gare de Lyon</div><div class="rc-station-city">Paris</div></div>
                </div>
              </div>
            </div>
            <div class="rc-footer">
              <div class="rc-conditions">
                <span class="rc-cond rc-cond-no">Non modifiable</span>
                <span class="rc-cond rc-cond-no">Non remboursable</span>
              </div>

            </div>
          </div>
        </div><!-- /d-reco-grid -->

        <div class="d-reco-see-all">
          <span class="d-see-all-prompt">Vous ne trouvez pas votre bonheur ?</span>
          <button class="d-see-all-btn" onclick="showAllView('trains')">Tous les trains <span class="d-see-all-count">(24)</span></button>
          <button class="d-see-all-btn" onclick="showAllView('flights')">Tous les vols <span class="d-see-all-count">(18)</span></button>
        </div>

        <!-- Detail zone: always below all 3 cards â€” content injected by toggleRecoDetail() -->
        <div class="d-reco-detail-zone" id="reco-detail-zone">
          <div class="d-reco-inline-detail" id="reco-detail-train1" style="display:none"></div>
          <div class="d-reco-inline-detail" id="reco-detail-flight1" style="display:none"></div>
          <div class="d-reco-inline-detail" id="reco-detail-train2" style="display:none"></div>
        </div><!-- /d-reco-detail-zone -->

      </div><!-- /d-reco-zone -->
      </div><!-- /view-recos -->

      <!-- ============================================ -->
      <!-- VIEW 2: ALL TRAINS (master-detail, hidden)   -->
      <!-- ============================================ -->
      <div id="view-all-trains" style="display:none">
        <div class="md-nav-bar">
          <a href="#" class="md-back" onclick="showRecoView(); return false">â† Recos</a>
          <div class="md-nav-chips" id="md-context-trains-out">
            <span class="d-ctx-chip">Paris GdL <span class="d-ctx-chevron">â€º</span></span>
            <span class="d-ctx-sep">â†’</span>
            <span class="d-ctx-chip">Lyon P-D <span class="d-ctx-chevron">â€º</span></span>
            <span class="d-ctx-dot">Â·</span>
            <span class="d-ctx-chip">16 jan. â†’ 23 jan. <span class="d-ctx-chevron">â€º</span></span>
            <span class="d-ctx-dot">Â·</span>
            <span class="d-ctx-static">3 voy.</span>
          </div>
          <div class="md-nav-chips" id="md-context-trains-ret" style="display:none">
            <span class="d-ctx-chip">Lyon P-D <span class="d-ctx-chevron">â€º</span></span>
            <span class="d-ctx-sep">â†’</span>
            <span class="d-ctx-chip">Paris GdL <span class="d-ctx-chevron">â€º</span></span>
            <span class="d-ctx-dot">Â·</span>
            <span class="d-ctx-chip">23 jan. <span class="d-ctx-chevron">â€º</span></span>
            <span class="d-ctx-dot">Â·</span>
            <span class="d-ctx-static">3 voy.</span>
          </div>
          <button class="md-switch-btn" onclick="showAllView('flights')">Voir les vols â†’</button>
        </div>
        <div class="md-phase-bar" id="md-guidance-trains">
          <span class="md-phase-title" id="md-stepper-instruction">Choix de l'aller</span>
          <span class="md-phase-leg" id="md-leg-summary" style="display:none">
            <svg width="14" height="14" viewBox="0 0 16 16" fill="none" style="flex-shrink:0"><circle cx="8" cy="8" r="7" fill="var(--color-positive)"/><path d="M5 8L7.2 10.2L11 5.8" stroke="#fff" stroke-width="1.3" stroke-linecap="round" stroke-linejoin="round"/></svg>
            <span id="md-leg-summary-text"></span>
            <button class="md-phase-edit" type="button" onclick="resetMdTrainOutbound()">Modifier</button>
          </span>
        </div>
        <div class="md-info-bar">Les trains complets ne sont pas affichÃ©s.</div>
        <div class="md-layout">
          <div class="md-list" id="md-train-list">
            <!-- Outbound trains -->
            <div id="md-train-outbound-list">
            <button class="md-page-btn" onclick="return false">â† Trains prÃ©cÃ©dents <span class="md-page-hint">avant 07:00</span></button>
            <div class="list-card" data-id="train1" onclick="selectMdItem('trains','train1-out')">
              <div class="lc-legs">
                <div class="lc-leg-header"><div class="lc-operator"><div class="lc-op-dot" style="background:#e3f2fd">ğŸš„</div><span class="lc-op-name">TGV INOUI</span></div><span class="lc-duration">2h Â· direct</span></div>
                <div class="lc-leg-body"><span class="lc-time">07:13</span><div class="lc-line"></div><span class="lc-time">09:13</span></div>
                <div class="lc-leg-footer">Paris Gare de Lyon â†’ Lyon Part-Dieu</div>
                <div class="lc-card-meta"><span class="tag tag-info">RecommandÃ©</span><span class="amenity-yes">Modifiable avec frais</span><span class="amenity-no">Non remboursable</span></div>
              </div>
              <div class="lc-classes"><div class="lc-class-box" onclick="event.stopPropagation(); selectMdItem('trains','train1-out')"><div class="lc-class-name">2nde classe</div><div class="lc-class-price">97 â‚¬</div></div><div class="lc-class-box" onclick="event.stopPropagation(); selectMdItem('trains','train1-out-1ere')"><div class="lc-class-name">1Ã¨re classe</div><div class="lc-class-price">153 â‚¬</div></div></div>
            </div>
            <div class="list-card" data-id="train2" onclick="selectMdItem('trains','train2-out')">
              <div class="lc-legs">
                <div class="lc-leg-header"><div class="lc-operator"><div class="lc-op-dot" style="background:#e8f5e9">ğŸš„</div><span class="lc-op-name">OuiGo</span></div><span class="lc-duration">2h30 Â· direct</span></div>
                <div class="lc-leg-body"><span class="lc-time">09:00</span><div class="lc-line"></div><span class="lc-time">11:30</span></div>
                <div class="lc-leg-footer">Paris Gare de Lyon â†’ Lyon Part-Dieu</div>
                <div class="lc-card-meta"><span class="tag tag-success">Moins cher</span></div>
              </div>
              <div class="lc-classes"><div class="lc-class-box"><div class="lc-class-name">Standard</div><div class="lc-class-price">65 â‚¬</div></div></div>
            </div>
            <div class="list-card" data-id="train3" onclick="selectMdItem('trains','train3-out')">
              <div class="lc-legs">
                <div class="lc-leg-header"><div class="lc-operator"><div class="lc-op-dot" style="background:#e3f2fd">ğŸš„</div><span class="lc-op-name">TGV INOUI</span></div><span class="lc-duration">2h Â· direct</span></div>
                <div class="lc-leg-body"><span class="lc-time">08:30</span><div class="lc-line"></div><span class="lc-time">10:30</span></div>
                <div class="lc-leg-footer">Paris Gare de Lyon â†’ Lyon Part-Dieu</div>
                <div class="lc-card-meta"><span class="amenity-yes">Modifiable sans frais</span><span class="amenity-yes">Remboursable avec frais</span></div>
              </div>
              <div class="lc-classes"><div class="lc-class-box" onclick="event.stopPropagation(); selectMdItem('trains','train3-out')"><div class="lc-class-name">2nde classe</div><div class="lc-class-price">106 â‚¬</div></div><div class="lc-class-box" onclick="event.stopPropagation(); selectMdItem('trains','train3-out-1ere')"><div class="lc-class-name">1Ã¨re classe</div><div class="lc-class-price">165 â‚¬</div></div></div>
            </div>
            <div class="list-card" data-id="train4" onclick="selectMdItem('trains','train4-out')">
              <div class="lc-legs">
                <div class="lc-leg-header"><div class="lc-operator"><div class="lc-op-dot" style="background:#e3f2fd">ğŸš„</div><span class="lc-op-name">TGV INOUI</span></div><span class="lc-duration">2h Â· direct</span></div>
                <div class="lc-leg-body"><span class="lc-time">10:00</span><div class="lc-line"></div><span class="lc-time">12:00</span></div>
                <div class="lc-leg-footer">Paris Gare de Lyon â†’ Lyon Part-Dieu</div>
                <div class="lc-card-meta"><span class="amenity-yes">Modifiable avec frais</span><span class="amenity-no">Non remboursable</span></div>
              </div>
              <div class="lc-classes"><div class="lc-class-box" onclick="event.stopPropagation(); selectMdItem('trains','train4-out')"><div class="lc-class-name">2nde classe</div><div class="lc-class-price">82 â‚¬</div></div><div class="lc-class-box" onclick="event.stopPropagation(); selectMdItem('trains','train4-out-1ere')"><div class="lc-class-name">1Ã¨re classe</div><div class="lc-class-price">138 â‚¬</div></div></div>
            </div>
            <div class="list-card" data-id="train5" onclick="selectMdItem('trains','train5-out')">
              <div class="lc-legs">
                <div class="lc-leg-header"><div class="lc-operator"><div class="lc-op-dot" style="background:#e8f5e9">ğŸš„</div><span class="lc-op-name">OuiGo</span></div><span class="lc-duration">2h30 Â· direct</span></div>
                <div class="lc-leg-body"><span class="lc-time">11:30</span><div class="lc-line"></div><span class="lc-time">14:00</span></div>
                <div class="lc-leg-footer">Paris Gare de Lyon â†’ Lyon Perrache</div>
                <div class="lc-card-meta"><span class="tag tag-success">Moins cher</span></div>
              </div>
              <div class="lc-classes"><div class="lc-class-box"><div class="lc-class-name">Standard</div><div class="lc-class-price">59 â‚¬</div></div></div>
            </div>
            <div class="list-card" data-id="train6" onclick="selectMdItem('trains','train6-out')">
              <div class="lc-legs">
                <div class="lc-leg-header"><div class="lc-operator"><div class="lc-op-dot" style="background:#e3f2fd">ğŸš„</div><span class="lc-op-name">TGV INOUI</span></div><span class="lc-duration">2h Â· direct</span></div>
                <div class="lc-leg-body"><span class="lc-time">14:00</span><div class="lc-line"></div><span class="lc-time">16:00</span></div>
                <div class="lc-leg-footer">Paris Gare de Lyon â†’ Lyon Part-Dieu</div>
                <div class="lc-card-meta"><span class="amenity-yes">Modifiable sans frais</span><span class="amenity-yes">Remboursable avec frais</span></div>
              </div>
              <div class="lc-classes"><div class="lc-class-box" onclick="event.stopPropagation(); selectMdItem('trains','train6-out')"><div class="lc-class-name">2nde classe</div><div class="lc-class-price">119 â‚¬</div></div><div class="lc-class-box" onclick="event.stopPropagation(); selectMdItem('trains','train6-out-1ere')"><div class="lc-class-name">1Ã¨re classe</div><div class="lc-class-price">185 â‚¬</div></div></div>
            </div>
            <div class="list-card" data-id="train7" onclick="selectMdItem('trains','train7-out')">
              <div class="lc-legs">
                <div class="lc-leg-header"><div class="lc-operator"><div class="lc-op-dot" style="background:#e8f5e9">ğŸš„</div><span class="lc-op-name">OuiGo</span></div><span class="lc-duration">2h30 Â· direct</span></div>
                <div class="lc-leg-body"><span class="lc-time">15:30</span><div class="lc-line"></div><span class="lc-time">18:00</span></div>
                <div class="lc-leg-footer">Paris Gare de Lyon â†’ Lyon Part-Dieu</div>
                <div class="lc-card-meta"><span class="tag tag-success">Eco</span></div>
              </div>
              <div class="lc-classes"><div class="lc-class-box"><div class="lc-class-name">Standard</div><div class="lc-class-price">70 â‚¬</div></div></div>
            </div>
            <button class="md-page-btn" onclick="return false">Trains suivants â†’ <span class="md-page-hint">aprÃ¨s 15:30</span></button>
            </div>
            <!-- Return trains (hidden) -->
            <div id="md-train-return-list" style="display:none">
            <button class="md-page-btn" onclick="return false">â† Trains prÃ©cÃ©dents <span class="md-page-hint">avant 17:00</span></button>
            <div class="list-card" data-id="trainR1" onclick="selectMdItem('trains','train1-ret')">
              <div class="lc-legs">
                <div class="lc-leg-header"><div class="lc-operator"><div class="lc-op-dot" style="background:#e3f2fd">ğŸš„</div><span class="lc-op-name">TGV INOUI</span></div><span class="lc-duration">2h Â· direct</span></div>
                <div class="lc-leg-body"><span class="lc-time">17:00</span><div class="lc-line"></div><span class="lc-time">19:00</span></div>
                <div class="lc-leg-footer">Lyon Part-Dieu â†’ Paris Gare de Lyon</div>
                <div class="lc-card-meta"><span class="tag tag-info">RecommandÃ©</span><span class="amenity-yes">Modifiable avec frais</span></div>
              </div>
              <div class="lc-classes"><div class="lc-class-box" onclick="event.stopPropagation(); selectMdItem('trains','train1-ret')"><div class="lc-class-name">2nde classe</div><div class="lc-class-price">97 â‚¬</div></div><div class="lc-class-box" onclick="event.stopPropagation(); selectMdItem('trains','train1-ret-1ere')"><div class="lc-class-name">1Ã¨re classe</div><div class="lc-class-price">153 â‚¬</div></div></div>
            </div>
            <div class="list-card" data-id="trainR2" onclick="selectMdItem('trains','train2-ret')">
              <div class="lc-legs">
                <div class="lc-leg-header"><div class="lc-operator"><div class="lc-op-dot" style="background:#e3f2fd">ğŸš„</div><span class="lc-op-name">TGV INOUI</span></div><span class="lc-duration">2h Â· direct</span></div>
                <div class="lc-leg-body"><span class="lc-time">18:00</span><div class="lc-line"></div><span class="lc-time">20:00</span></div>
                <div class="lc-leg-footer">Lyon Part-Dieu â†’ Paris Gare de Lyon</div>
                <div class="lc-card-meta"><span class="amenity-yes">Modifiable sans frais</span><span class="amenity-yes">Remboursable avec frais</span></div>
              </div>
              <div class="lc-classes"><div class="lc-class-box" onclick="event.stopPropagation(); selectMdItem('trains','train2-ret')"><div class="lc-class-name">2nde classe</div><div class="lc-class-price">106 â‚¬</div></div><div class="lc-class-box" onclick="event.stopPropagation(); selectMdItem('trains','train2-ret-1ere')"><div class="lc-class-name">1Ã¨re classe</div><div class="lc-class-price">165 â‚¬</div></div></div>
            </div>
            <div class="list-card" data-id="trainR3" onclick="selectMdItem('trains','train3-ret')">
              <div class="lc-legs">
                <div class="lc-leg-header"><div class="lc-operator"><div class="lc-op-dot" style="background:#e8f5e9">ğŸš„</div><span class="lc-op-name">OuiGo</span></div><span class="lc-duration">2h30 Â· direct</span></div>
                <div class="lc-leg-body"><span class="lc-time">19:30</span><div class="lc-line"></div><span class="lc-time">22:00</span></div>
                <div class="lc-leg-footer">Lyon Part-Dieu â†’ Paris Gare de Lyon</div>
                <div class="lc-card-meta"><span class="tag tag-success">Moins cher</span></div>
              </div>
              <div class="lc-classes"><div class="lc-class-box"><div class="lc-class-name">Standard</div><div class="lc-class-price">65 â‚¬</div></div></div>
            </div>
            <div class="list-card" data-id="trainR4" onclick="selectMdItem('trains','train4-ret')">
              <div class="lc-legs">
                <div class="lc-leg-header"><div class="lc-operator"><div class="lc-op-dot" style="background:#e3f2fd">ğŸš„</div><span class="lc-op-name">TGV INOUI</span></div><span class="lc-duration">2h Â· direct</span></div>
                <div class="lc-leg-body"><span class="lc-time">19:00</span><div class="lc-line"></div><span class="lc-time">21:00</span></div>
                <div class="lc-leg-footer">Lyon Part-Dieu â†’ Paris Gare de Lyon</div>
                <div class="lc-card-meta"><span class="amenity-yes">Modifiable avec frais</span></div>
              </div>
              <div class="lc-classes"><div class="lc-class-box" onclick="event.stopPropagation(); selectMdItem('trains','train4-ret')"><div class="lc-class-name">2nde classe</div><div class="lc-class-price">119 â‚¬</div></div><div class="lc-class-box" onclick="event.stopPropagation(); selectMdItem('trains','train4-ret-1ere')"><div class="lc-class-name">1Ã¨re classe</div><div class="lc-class-price">185 â‚¬</div></div></div>
            </div>
            <div class="list-card" data-id="trainR5" onclick="selectMdItem('trains','train5-ret')">
              <div class="lc-legs">
                <div class="lc-leg-header"><div class="lc-operator"><div class="lc-op-dot" style="background:#e8f5e9">ğŸš„</div><span class="lc-op-name">OuiGo</span></div><span class="lc-duration">2h30 Â· direct</span></div>
                <div class="lc-leg-body"><span class="lc-time">20:30</span><div class="lc-line"></div><span class="lc-time">23:00</span></div>
                <div class="lc-leg-footer">Lyon Part-Dieu â†’ Paris Gare de Lyon</div>
                <div class="lc-card-meta"><span class="tag tag-success">Eco</span></div>
              </div>
              <div class="lc-classes"><div class="lc-class-box"><div class="lc-class-name">Standard</div><div class="lc-class-price">59 â‚¬</div></div></div>
            </div>
            <button class="md-page-btn" onclick="return false">Trains suivants â†’ <span class="md-page-hint">aprÃ¨s 20:30</span></button>
            </div>
          </div>
          <div class="md-detail" id="md-train-detail">
            <div class="md-detail-placeholder">SÃ©lectionnez un train pour voir les dÃ©tails</div>
          </div>
        </div>
      </div><!-- /view-all-trains -->

      <!-- ============================================ -->
      <!-- VIEW 3: ALL FLIGHTS (master-detail, hidden)  -->
      <!-- ============================================ -->
      <div id="view-all-flights" style="display:none">
        <div class="md-nav-bar">
          <a href="#" class="md-back" onclick="showRecoView(); return false">â† Recos</a>
          <div class="md-nav-chips">
            <span class="d-ctx-chip">PAR <span class="d-ctx-chevron">â€º</span></span>
            <span class="d-ctx-sep">â†’</span>
            <span class="d-ctx-chip">LYS <span class="d-ctx-chevron">â€º</span></span>
            <span class="d-ctx-dot">Â·</span>
            <span class="d-ctx-chip">16 jan. â†’ 23 jan. <span class="d-ctx-chevron">â€º</span></span>
            <span class="d-ctx-dot">Â·</span>
            <span class="d-ctx-static">3 voy.</span>
          </div>
          <button class="md-switch-btn" onclick="showAllView('trains')">Voir les trains â†’</button>
        </div>
        <div class="d-hotel-filters-row" style="margin-bottom:8px">
          <div class="filter-chip sort-chip" id="flight-sort-chip" onclick="toggleSortDropdown()">
            <svg width="12" height="12" viewBox="0 0 16 16" fill="none" style="flex-shrink:0"><path d="M2 4h12M4 8h8M6 12h4" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/></svg>
            <span id="flight-sort-label">Pertinence</span>
            <span class="fc-chevron">â€º</span>
            <div class="sort-dropdown" id="sort-dropdown">
              <div class="sort-option active" data-sort="relevance" onclick="event.stopPropagation(); sortFlights('relevance')">Pertinence</div>
              <div class="sort-option" data-sort="departure" onclick="event.stopPropagation(); sortFlights('departure')">Heure de dÃ©part</div>
              <div class="sort-option" data-sort="arrival" onclick="event.stopPropagation(); sortFlights('arrival')">Heure d'arrivÃ©e</div>
              <div class="sort-option" data-sort="price" onclick="event.stopPropagation(); sortFlights('price')">Prix</div>
            </div>
          </div>
          <button class="d-filter-all-btn"><svg width="14" height="14" viewBox="0 0 16 16" fill="none"><path d="M1.5 2h13L9.5 8.5V13l-3 1.5V8.5L1.5 2z" stroke="currentColor" stroke-width="1.4" stroke-linejoin="round"/></svg> Tous les filtres</button>
          <div class="d-filter-chips-row">
            <div class="filter-chip">Prix <span class="fc-chevron">â€º</span></div>
            <div class="filter-chip">DurÃ©e <span class="fc-chevron">â€º</span></div>
            <div class="filter-chip">Escales <span class="fc-chevron">â€º</span></div>
            <div class="filter-chip">Compagnie <span class="fc-chevron">â€º</span></div>
            <div class="filter-chip">Bagages <span class="fc-chevron">â€º</span></div>
            <div class="filter-chip">Horaire <span class="fc-chevron">â€º</span></div>
          </div>
        </div>
        <div class="d-guidance" id="md-guidance-flights">
          <span>Vol <strong>aller-retour</strong> â€” prix affichÃ©s : tarif le moins cher par classe.</span>
          <button class="d-guidance-dismiss" onclick="this.closest('.d-guidance').style.display='none'">Ã—</button>
        </div>
        <div class="md-layout">
          <div class="md-list" id="md-flight-list">
            <div class="list-card" data-id="flight1" onclick="selectMdItem('flights','flight1')">
              <div class="lc-legs">
                <div class="lc-leg-header"><div class="lc-operator"><div class="lc-op-dot" style="background:#e8eaf6">âœˆï¸</div><span class="lc-op-name">Air France</span></div><span class="lc-duration">1h10</span><span class="lc-class-label">Â· Economy</span></div>
                <div class="lc-leg-body"><span class="lc-time">07:00</span><div class="lc-line lc-line--flight"></div><span class="lc-time">08:10</span></div>
                <div class="lc-leg-footer"><span class="lc-iata">CDG</span> <span class="lc-airport-name">Paris CDG</span> â†’ <span class="lc-iata">LYS</span> <span class="lc-airport-name">Lyon St-ExupÃ©ry</span></div>
                <div class="lc-leg-divider"></div>
                <div class="lc-leg-header"><div class="lc-operator"><div class="lc-op-dot" style="background:#e8eaf6">âœˆï¸</div><span class="lc-op-name">Air France</span></div><span class="lc-duration">1h10</span><span class="lc-class-label">Â· Economy</span></div>
                <div class="lc-leg-body"><span class="lc-time">20:30</span><div class="lc-line lc-line--flight"></div><span class="lc-time">21:40</span></div>
                <div class="lc-leg-footer"><span class="lc-iata">LYS</span> <span class="lc-airport-name">Lyon St-ExupÃ©ry</span> â†’ <span class="lc-iata">CDG</span> <span class="lc-airport-name">Paris CDG</span></div>
              </div>
              <div class="lc-flight-aside">
                <div class="lc-flight-tags"><span class="tag tag-fast">Plus rapide</span></div>
                <div class="lc-flight-luggage"><span class="lc-flight-luggage-item"><span class="lc-flight-luggage-count">1</span>ğŸ§³</span><span class="lc-flight-luggage-item"><span class="lc-flight-luggage-count">1</span>ğŸ›„ 23kg</span></div>
                <div class="lc-flight-price"><div class="lc-flight-price-total">126 â‚¬</div><div class="lc-flight-price-pax">42 â‚¬ /pax</div></div>
              </div>
            </div>
            <div class="list-card" data-id="flight2" onclick="selectMdItem('flights','flight2')">
              <div class="lc-legs">
                <div class="lc-leg-header"><div class="lc-operator"><div class="lc-op-dot" style="background:#fff3e0">âœˆï¸</div><span class="lc-op-name">easyJet</span></div><span class="lc-duration">1h15</span><span class="lc-class-label">Â· Standard</span></div>
                <div class="lc-leg-body"><span class="lc-time">06:30</span><div class="lc-line lc-line--flight"></div><span class="lc-time">07:45</span></div>
                <div class="lc-leg-footer"><span class="lc-iata">ORY</span> <span class="lc-airport-name">Paris Orly</span> â†’ <span class="lc-iata">LYS</span> <span class="lc-airport-name">Lyon St-ExupÃ©ry</span></div>
                <div class="lc-leg-divider"></div>
                <div class="lc-leg-header"><div class="lc-operator"><div class="lc-op-dot" style="background:#fff3e0">âœˆï¸</div><span class="lc-op-name">easyJet</span></div><span class="lc-duration">1h15</span><span class="lc-class-label">Â· Standard</span></div>
                <div class="lc-leg-body"><span class="lc-time">21:00</span><div class="lc-line lc-line--flight"></div><span class="lc-time">22:15</span></div>
                <div class="lc-leg-footer"><span class="lc-iata">LYS</span> <span class="lc-airport-name">Lyon St-ExupÃ©ry</span> â†’ <span class="lc-iata">ORY</span> <span class="lc-airport-name">Paris Orly</span></div>
              </div>
              <div class="lc-flight-aside">
                <div class="lc-flight-tags"><span class="tag tag-success">Moins cher</span></div>
                <div class="lc-flight-luggage"><span class="lc-flight-luggage-item"><span class="lc-flight-luggage-count">1</span>ğŸ§³ 12kg</span></div>
                <div class="lc-flight-price"><div class="lc-flight-price-total">104 â‚¬</div><div class="lc-flight-price-pax">35 â‚¬ /pax</div></div>
              </div>
            </div>
            <div class="list-card" data-id="flight3" onclick="selectMdItem('flights','flight3')">
              <div class="lc-legs">
                <div class="lc-leg-header"><div class="lc-operator"><div class="lc-op-dot" style="background:#e8eaf6">âœˆï¸</div><span class="lc-op-name">Air France</span></div><span class="lc-duration">1h10</span><span class="lc-class-label">Â· Economy</span></div>
                <div class="lc-leg-body"><span class="lc-time">12:00</span><div class="lc-line lc-line--flight"></div><span class="lc-time">13:10</span></div>
                <div class="lc-leg-footer"><span class="lc-iata">CDG</span> <span class="lc-airport-name">Paris CDG</span> â†’ <span class="lc-iata">LYS</span> <span class="lc-airport-name">Lyon St-ExupÃ©ry</span></div>
                <div class="lc-leg-divider"></div>
                <div class="lc-leg-header"><div class="lc-operator"><div class="lc-op-dot" style="background:#e8eaf6">âœˆï¸</div><span class="lc-op-name">Air France</span></div><span class="lc-duration">1h10</span><span class="lc-class-label">Â· Economy</span></div>
                <div class="lc-leg-body"><span class="lc-time">19:00</span><div class="lc-line lc-line--flight"></div><span class="lc-time">20:10</span></div>
                <div class="lc-leg-footer"><span class="lc-iata">LYS</span> <span class="lc-airport-name">Lyon St-ExupÃ©ry</span> â†’ <span class="lc-iata">CDG</span> <span class="lc-airport-name">Paris CDG</span></div>
                <div class="lc-card-meta"><span class="amenity-yes">Modifiable sans frais</span><span class="amenity-yes">Remboursable en avoir</span></div>
              </div>
              <div class="lc-flight-aside">
                <div class="lc-flight-tags"><span class="tag tag-danger">Hors budget</span></div>
                <div class="lc-flight-luggage"><span class="lc-flight-luggage-item"><span class="lc-flight-luggage-count">1</span>ğŸ§³</span><span class="lc-flight-luggage-item"><span class="lc-flight-luggage-count">1</span>ğŸ›„ 23kg</span></div>
                <div class="lc-flight-price"><div class="lc-flight-price-total">151 â‚¬</div><div class="lc-flight-price-pax">50 â‚¬ /pax</div></div>
              </div>
            </div>
          </div>
          <div class="md-detail" id="md-flight-detail">
            <div class="md-detail-placeholder">SÃ©lectionnez un vol pour voir les dÃ©tails</div>
          </div>
        </div>
      </div><!-- /view-all-flights -->

    </div>
  </div>

  <!-- ================================================ -->
  <!-- STEP 2: HOTEL (split view: list + map)           -->
  <!-- ================================================ -->
  <div class="step-content" id="step-hotel">
    <div class="hotel-split">
      <!-- Left: hotel list -->
      <div class="hotel-split-list">

        <!-- Transport recap (green confirmation bar) -->
        <div class="d-transport-recap" id="hotel-transport-summary">
          <span class="d-transport-recap-check">âœ“</span>
          <span class="d-transport-recap-text">Transport : <strong id="hts-label">TGV INOUI Â· 2nde Classe</strong></span>
          <span class="d-transport-recap-price" id="hts-price">290 â‚¬</span>
          <span class="d-transport-recap-edit" onclick="goToStep('transport')">Modifier</span>
        </div>

        <!-- Hotel hero (same pattern as transport) -->
        <div class="d-hero" style="display:flex;align-items:flex-start;justify-content:space-between;gap:16px">
          <div>
            <div class="d-hero-title">Choix de l'hÃ©bergement</div>
            <div class="d-hero-sub">Lyon Â· 7 nuitÃ©es Â· <strong>32 hÃ´tels</strong> disponibles Â· budget max 150 â‚¬/nuit</div>
          </div>
          <button class="d-hotel-skip-btn" onclick="skipHotel()">Pas besoin d'hÃ´tel â†’</button>
        </div>

        <!-- Hotel filters bar -->
        <div class="d-hotel-filters-row" style="margin-bottom:14px">
          <button class="d-filter-all-btn"><svg width="14" height="14" viewBox="0 0 16 16" fill="none"><path d="M1.5 2h13L9.5 8.5V13l-3 1.5V8.5L1.5 2z" stroke="currentColor" stroke-width="1.4" stroke-linejoin="round"/></svg> Tous les filtres</button>
          <div class="d-filter-chips-row">
            <div class="filter-chip">Prix <span class="fc-chevron">â€º</span></div>
            <div class="filter-chip">Budget <span class="fc-chevron">â€º</span></div>
            <div class="filter-chip">Repas <span class="fc-chevron">â€º</span></div>
            <div class="filter-chip">Lits <span class="fc-chevron">â€º</span></div>
            <div class="filter-chip">Ã‰toiles <span class="fc-chevron">â€º</span></div>
            <div class="filter-chip">ChaÃ®ne <span class="fc-chevron">â€º</span></div>
            <div class="filter-chip">Conditions d'annulation <span class="fc-chevron">â€º</span></div>
          </div>
        </div>

        <!-- RecommandÃ©s -->
        <div class="d-divider-label"><span>RecommandÃ©s</span></div>
        <!-- Hotel cards: match HotelResultListCard layout -->
        <div class="hotel-list-card" data-id="hotel1" onclick="openDrawer('hotel1')">
          <div class="hlc-img">
            <div class="hlc-img-top">
              <div class="hlc-img-rating"><span class="hlc-img-rating-score">8.6</span><div class="hlc-img-rating-info"><span class="hlc-img-rating-label">TrÃ¨s bien</span><span class="hlc-img-rating-count">1 247 avis</span></div></div>
              <button class="hlc-fav" title="Ajouter aux favoris">â™¡</button>
            </div>
            <div class="hlc-img-bottom"><span class="tag tag-info" style="font-size:9px;padding:2px 6px">RecommandÃ©</span></div>
          </div>
          <div class="hlc-body">
            <div class="hlc-top"><span class="hlc-name">Mercure Lyon Centre ChÃ¢teau Perrache</span><span class="hlc-stars">â˜…â˜…â˜…â˜…</span></div>
            <div class="hlc-subtitle"><span class="hlc-chain">Mercure Â· Accor</span></div>
            <div class="hlc-location"><span class="hlc-location-icon">ğŸ“</span> 0.3 km de la destination</div>
            <div class="hlc-room">Chambre Double</div>
            <div class="hlc-features"><span class="hlc-feature-item">ğŸ›ï¸ Double</span><span class="hlc-feature-item">âœ“ Annulable</span><span class="hlc-feature-item">â˜• PDJ inclus</span></div>
            <div class="hlc-price-block">
                            <div class="hlc-price-area"><div class="hlc-price">742 â‚¬</div><div class="hlc-price-detail">7 nuits, 106 â‚¬ par nuit</div></div>
            </div>
          </div>
        </div>
        <div class="hotel-list-card" data-id="hotel2" onclick="openDrawer('hotel2')">
          <div class="hlc-img">
            <div class="hlc-img-top">
              <div class="hlc-img-rating"><span class="hlc-img-rating-score mid">7.8</span><div class="hlc-img-rating-info"><span class="hlc-img-rating-label">Bien</span><span class="hlc-img-rating-count">892 avis</span></div></div>
              <button class="hlc-fav" title="Ajouter aux favoris">â™¡</button>
            </div>
            <div class="hlc-img-bottom"><span class="tag tag-success" style="font-size:9px;padding:2px 6px">Moins cher</span></div>
          </div>
          <div class="hlc-body">
            <div class="hlc-top"><span class="hlc-name">Ibis Lyon Gare de la Part-Dieu</span><span class="hlc-stars">â˜…â˜…â˜…</span></div>
            <div class="hlc-subtitle"><span class="hlc-chain">Ibis Â· Accor</span></div>
            <div class="hlc-location"><span class="hlc-location-icon">ğŸ“</span> 0.1 km de la destination</div>
            <div class="hlc-room">Chambre Double</div>
            <div class="hlc-features"><span class="hlc-feature-item">ğŸ›ï¸ Double</span><span class="hlc-feature-item">âœ“ Annulable</span></div>
            <div class="hlc-price-block">
                            <div class="hlc-price-area"><div class="hlc-price">518 â‚¬</div><div class="hlc-price-detail">7 nuits, 74 â‚¬ par nuit</div></div>
            </div>
          </div>
        </div>
        <div class="hotel-list-card" data-id="hotel3" onclick="openDrawer('hotel3')">
          <div class="hlc-img">
            <div class="hlc-img-top">
              <div class="hlc-img-rating"><span class="hlc-img-rating-score high">8.9</span><div class="hlc-img-rating-info"><span class="hlc-img-rating-label">Superbe</span><span class="hlc-img-rating-count">2 103 avis</span></div></div>
              <button class="hlc-fav" title="Ajouter aux favoris">â™¡</button>
            </div>
            <div class="hlc-img-bottom"><span class="tag tag-fast" style="font-size:9px;padding:2px 6px">Populaire</span></div>
          </div>
          <div class="hlc-body">
            <div class="hlc-top"><span class="hlc-name">Novotel Lyon Confluence</span><span class="hlc-stars">â˜…â˜…â˜…â˜…</span></div>
            <div class="hlc-subtitle"><span class="hlc-chain">Novotel Â· Accor</span></div>
            <div class="hlc-location"><span class="hlc-location-icon">ğŸ“</span> 1.2 km de la destination</div>
            <div class="hlc-room">Chambre Queen</div>
            <div class="hlc-features"><span class="hlc-feature-item">ğŸ›ï¸ Queen</span><span class="hlc-feature-item">âœ“ Annulable</span><span class="hlc-feature-item">â˜• PDJ inclus</span></div>
            <div class="hlc-price-block">
                            <div class="hlc-price-area"><div class="hlc-price">896 â‚¬</div><div class="hlc-price-detail">7 nuits, 128 â‚¬ par nuit</div></div>
            </div>
          </div>
        </div>

        <!-- All hotels -->
        <div style="font-size:11px;font-weight:700;text-transform:uppercase;letter-spacing:0.5px;color:var(--text-muted);margin:12px 0 6px">Tous les hÃ´tels</div>
        <div class="hotel-list-card" data-id="hotel4" onclick="openDrawer('hotel1')">
          <div class="hlc-img">
            <div class="hlc-img-top">
              <div class="hlc-img-rating"><span class="hlc-img-rating-score high">9.1</span><div class="hlc-img-rating-info"><span class="hlc-img-rating-label">Superbe</span><span class="hlc-img-rating-count">3 412 avis</span></div></div>
              <button class="hlc-fav" title="Ajouter aux favoris">â™¡</button>
            </div>
            <div class="hlc-img-bottom"><span class="tag tag-danger" style="font-size:9px;padding:2px 6px">Hors budget</span></div>
          </div>
          <div class="hlc-body">
            <div class="hlc-top"><span class="hlc-name">Crowne Plaza Lyon â€” CitÃ© Internationale</span><span class="hlc-stars">â˜…â˜…â˜…â˜…â˜…</span></div>
            <div class="hlc-subtitle"><span class="hlc-chain">Crowne Plaza Â· IHG</span></div>
            <div class="hlc-location"><span class="hlc-location-icon">ğŸ“</span> 0.8 km de la destination</div>
            <div class="hlc-room">Chambre King</div>
            <div class="hlc-features"><span class="hlc-feature-item">ğŸ›ï¸ King</span><span class="hlc-feature-item">âœ“ Annulable</span><span class="hlc-feature-item">ğŸŠ Piscine</span></div>
            <div class="hlc-price-block">
                            <div class="hlc-price-area"><div class="hlc-price">1 540 â‚¬</div><div class="hlc-price-detail">7 nuits, 220 â‚¬ par nuit</div></div>
            </div>
          </div>
        </div>
        <div class="hotel-list-card" data-id="hotel5" onclick="openDrawer('hotel2')">
          <div class="hlc-img">
            <div class="hlc-img-top">
              <div class="hlc-img-rating"><span class="hlc-img-rating-score mid">7.2</span><div class="hlc-img-rating-info"><span class="hlc-img-rating-label">Bien</span><span class="hlc-img-rating-count">645 avis</span></div></div>
              <button class="hlc-fav" title="Ajouter aux favoris">â™¡</button>
            </div>
            <div class="hlc-img-bottom"></div>
          </div>
          <div class="hlc-body">
            <div class="hlc-top"><span class="hlc-name">B&B Hotel Lyon Centre Part-Dieu</span><span class="hlc-stars">â˜…â˜…</span></div>
            <div class="hlc-subtitle"><span class="hlc-chain">B&B Hotels</span></div>
            <div class="hlc-location"><span class="hlc-location-icon">ğŸ“</span> 0.2 km de la destination</div>
            <div class="hlc-room">Chambre Double</div>
            <div class="hlc-features"><span class="hlc-feature-item">ğŸ›ï¸ Double</span><span class="hlc-feature-item hlc-feature-excluded">Non annulable</span></div>
            <div class="hlc-price-block">
                            <div class="hlc-price-area"><div class="hlc-price">462 â‚¬</div><div class="hlc-price-detail">7 nuits, 66 â‚¬ par nuit</div></div>
            </div>
          </div>
        </div>
        <div class="hotel-list-card pagination-hidden" data-id="hotel6" onclick="openDrawer('hotel1')">
          <div class="hlc-img">
            <div class="hlc-img-top"><div class="hlc-img-rating"><span class="hlc-img-rating-score">8.4</span><div class="hlc-img-rating-info"><span class="hlc-img-rating-label">TrÃ¨s bien</span><span class="hlc-img-rating-count">1 876 avis</span></div></div><button class="hlc-fav">â™¡</button></div>
            <div class="hlc-img-bottom"></div>
          </div>
          <div class="hlc-body">
            <div class="hlc-top"><span class="hlc-name">Radisson Blu Lyon</span><span class="hlc-stars">â˜…â˜…â˜…â˜…</span></div>
            <div class="hlc-subtitle"><span class="hlc-chain">Radisson Â· Radisson Hotel Group</span></div>
            <div class="hlc-location"><span class="hlc-location-icon">ğŸ“</span> 0.9 km de la destination</div>
            <div class="hlc-room">Chambre Standard</div>
            <div class="hlc-features"><span class="hlc-feature-item">â˜• PDJ inclus</span><span class="hlc-feature-item">ğŸ½ï¸ Restaurant</span></div>
            <div class="hlc-price-block"><div class="hlc-price-area"><div class="hlc-price">924 â‚¬</div><div class="hlc-price-detail">7 nuits, 132 â‚¬ par nuit</div></div></div>
          </div>
        </div>
        <div class="hotel-list-card pagination-hidden" data-id="hotel7" onclick="openDrawer('hotel2')">
          <div class="hlc-img">
            <div class="hlc-img-top"><div class="hlc-img-rating"><span class="hlc-img-rating-score low">6.8</span><div class="hlc-img-rating-info"><span class="hlc-img-rating-label">Correct</span><span class="hlc-img-rating-count">412 avis</span></div></div><button class="hlc-fav">â™¡</button></div>
            <div class="hlc-img-bottom"></div>
          </div>
          <div class="hlc-body">
            <div class="hlc-top"><span class="hlc-name">PremiÃ¨re Classe Lyon Centre</span><span class="hlc-stars">â˜…â˜…</span></div>
            <div class="hlc-subtitle"><span class="hlc-chain">PremiÃ¨re Classe Â· Louvre Hotels</span></div>
            <div class="hlc-location"><span class="hlc-location-icon">ğŸ“</span> 0.5 km de la destination</div>
            <div class="hlc-room">Chambre Double</div>
            <div class="hlc-features"><span class="hlc-feature-item">ğŸ›ï¸ Double</span><span class="hlc-feature-item hlc-feature-excluded">Non annulable</span></div>
            <div class="hlc-price-block"><div class="hlc-price-area"><div class="hlc-price">385 â‚¬</div><div class="hlc-price-detail">7 nuits, 55 â‚¬ par nuit</div></div></div>
          </div>
        </div>
        <div class="hotel-list-card pagination-hidden" data-id="hotel8" onclick="openDrawer('hotel3')">
          <div class="hlc-img">
            <div class="hlc-img-top"><div class="hlc-img-rating"><span class="hlc-img-rating-score">8.1</span><div class="hlc-img-rating-info"><span class="hlc-img-rating-label">TrÃ¨s bien</span><span class="hlc-img-rating-count">2 341 avis</span></div></div><button class="hlc-fav">â™¡</button></div>
            <div class="hlc-img-bottom"></div>
          </div>
          <div class="hlc-body">
            <div class="hlc-top"><span class="hlc-name">Mama Shelter Lyon</span><span class="hlc-stars">â˜…â˜…â˜…</span></div>
            <div class="hlc-subtitle"><span class="hlc-chain">Mama Shelter</span></div>
            <div class="hlc-location"><span class="hlc-location-icon">ğŸ“</span> 1.5 km de la destination</div>
            <div class="hlc-room">Chambre Standard</div>
            <div class="hlc-features"><span class="hlc-feature-item">ğŸ½ï¸ Restaurant</span><span class="hlc-feature-item">âœ“ Annulable</span></div>
            <div class="hlc-price-block"><div class="hlc-price-area"><div class="hlc-price">679 â‚¬</div><div class="hlc-price-detail">7 nuits, 97 â‚¬ par nuit</div></div></div>
          </div>
        </div>
        <div class="hotel-list-card pagination-hidden" data-id="hotel9" onclick="openDrawer('hotel1')">
          <div class="hlc-img">
            <div class="hlc-img-top"><div class="hlc-img-rating"><span class="hlc-img-rating-score high">9.3</span><div class="hlc-img-rating-info"><span class="hlc-img-rating-label">Exceptionnel</span><span class="hlc-img-rating-count">4 012 avis</span></div></div><button class="hlc-fav">â™¡</button></div>
            <div class="hlc-img-bottom"><span class="tag tag-danger" style="font-size:9px;padding:2px 6px">Hors budget</span></div>
          </div>
          <div class="hlc-body">
            <div class="hlc-top"><span class="hlc-name">Lyon Marriott CitÃ© Internationale</span><span class="hlc-stars">â˜…â˜…â˜…â˜…â˜…</span></div>
            <div class="hlc-subtitle"><span class="hlc-chain">Marriott International</span></div>
            <div class="hlc-location"><span class="hlc-location-icon">ğŸ“</span> 2 km de la destination</div>
            <div class="hlc-room">Chambre Deluxe King</div>
            <div class="hlc-features"><span class="hlc-feature-item">ğŸ›ï¸ King</span><span class="hlc-feature-item">ğŸŠ Piscine</span><span class="hlc-feature-item">ğŸ’† Spa</span></div>
            <div class="hlc-price-block"><div class="hlc-price-area"><div class="hlc-price">1 680 â‚¬</div><div class="hlc-price-detail">7 nuits, 240 â‚¬ par nuit</div></div></div>
          </div>
        </div>
        <div class="hotel-list-card pagination-hidden" data-id="hotel10" onclick="openDrawer('hotel2')">
          <div class="hlc-img">
            <div class="hlc-img-top"><div class="hlc-img-rating"><span class="hlc-img-rating-score mid">7.0</span><div class="hlc-img-rating-info"><span class="hlc-img-rating-label">Bien</span><span class="hlc-img-rating-count">328 avis</span></div></div><button class="hlc-fav">â™¡</button></div>
            <div class="hlc-img-bottom"></div>
          </div>
          <div class="hlc-body">
            <div class="hlc-top"><span class="hlc-name">SÃ©jours & Affaires Saxe-Gambetta</span><span class="hlc-stars">â˜…â˜…</span></div>
            <div class="hlc-subtitle"><span class="hlc-chain">SÃ©jours & Affaires</span></div>
            <div class="hlc-location"><span class="hlc-location-icon">ğŸ“</span> 0.6 km de la destination</div>
            <div class="hlc-room">Studio Kitchenette</div>
            <div class="hlc-features"><span class="hlc-feature-item">ğŸ§º Kitchenette</span><span class="hlc-feature-item hlc-feature-excluded">Non annulable</span></div>
            <div class="hlc-price-block"><div class="hlc-price-area"><div class="hlc-price">434 â‚¬</div><div class="hlc-price-detail">7 nuits, 62 â‚¬ par nuit</div></div></div>
          </div>
        </div>
        <button class="pagination-btn" onclick="loadMore('hotels')">Afficher les 5 hÃ´tels suivants â–¾ <span style="color:var(--text-muted);font-weight:400">(22 restants)</span></button>
      </div>

      <!-- Right: permanent map -->
      <div class="hotel-split-map">
        <div class="map-container">
          <div class="map-bg">
            <div class="map-bg-grid"></div>
            <div class="map-bg-road h" style="top:25%"></div>
            <div class="map-bg-road h" style="top:45%"></div>
            <div class="map-bg-road h" style="top:65%"></div>
            <div class="map-bg-road h" style="top:82%"></div>
            <div class="map-bg-road v" style="left:20%"></div>
            <div class="map-bg-road v" style="left:40%"></div>
            <div class="map-bg-road v" style="left:60%"></div>
            <div class="map-bg-road v" style="left:80%"></div>
            <div class="map-bg-park" style="top:8%;left:55%;width:100px;height:70px"></div>
            <div class="map-bg-park" style="top:70%;left:15%;width:60px;height:40px"></div>
            <div class="map-bg-water" style="top:55%;left:5%;width:140px;height:60px"></div>
          </div>
          <div class="map-center-marker">ğŸ“</div>
          <div class="map-pin active budget-ok" style="top:40%;left:38%" data-hotel="hotel1" onclick="openDrawer('hotel1')">106 â‚¬</div>
          <div class="map-pin budget-ok" style="top:30%;left:52%" data-hotel="hotel2" onclick="openDrawer('hotel2')">74 â‚¬</div>
          <div class="map-pin budget-ok" style="top:62%;left:32%" data-hotel="hotel3" onclick="openDrawer('hotel3')">128 â‚¬</div>
          <div class="map-pin budget-over" style="top:22%;left:65%" data-hotel="hotel4" onclick="openDrawer('hotel1')">220 â‚¬</div>
          <div class="map-pin budget-ok" style="top:48%;left:55%" data-hotel="hotel5" onclick="openDrawer('hotel2')">66 â‚¬</div>
          <div class="map-pin budget-ok" style="top:52%;left:25%" data-hotel="hotel6">132 â‚¬</div>
          <div class="map-pin budget-ok" style="top:72%;left:48%" data-hotel="hotel7">55 â‚¬</div>
          <div class="map-pin budget-ok" style="top:38%;left:78%" data-hotel="hotel8">97 â‚¬</div>
          <div class="map-label">ğŸ“ Lyon Part-Dieu Â· 32 hÃ´tels</div>
        </div>
      </div>
    </div>
  </div>

  <!-- ================================================ -->
  <!-- STEP 3: RECAP (enriched)                         -->
  <!-- ================================================ -->
  <div class="step-content" id="step-recap">
    <div style="overflow-y:auto;height:100%">
      <div class="recap-view">
        <div class="recap-title">Review & Options</div>
        <div class="recap-subtitle">Paris â†’ Lyon Â· 16 â€“ 23 jan. 2025 Â· 3 voyageurs</div>

        <div class="guidance-card" id="guidance-review">
          <span class="guidance-card-text">VÃ©rifiez les dÃ©tails de votre voyage. Vous pouvez <strong>revenir modifier chaque Ã©lÃ©ment</strong> via les boutons "Modifier".</span>
          <button class="guidance-card-dismiss" aria-label="Fermer" onclick="dismissGuidance('guidance-review')">Ã—</button>
        </div>

        <div class="recap-card">
          <div class="recap-card-header">
            <div class="recap-card-title">ğŸš„ Transport</div>
            <span class="recap-modify" onclick="goToStep('transport')">Modifier</span>
          </div>
          <div class="recap-row"><span id="recap-transport-name">TGV INOUI Â· 2nde Classe</span><span id="recap-transport-price">290 â‚¬</span></div>
          <div class="recap-row sub"><span>Aller : Ven. 16 jan. 07:13 â†’ 09:13 Â· Retour : Ven. 23 jan. 18:00 â†’ 20:00</span></div>
          <div class="recap-conditions"><span class="amenity-yes">Modifiable avec frais</span><span class="amenity-no">Non remboursable</span><span>ğŸŒ¿ 2,4 kg CO2</span></div>
        </div>

        <div class="recap-card" id="recap-hotel-card">
          <div class="recap-card-header">
            <div class="recap-card-title">ğŸ¨ HÃ´tel</div>
            <span class="recap-modify" onclick="goToStep('hotel')">Modifier</span>
          </div>
          <div class="recap-row"><span id="recap-hotel-name">Mercure Lyon Centre Â· Standard Double</span><span id="recap-hotel-price">742 â‚¬</span></div>
          <div class="recap-row sub"><span>7 nuits Â· 106 â‚¬/nuit Â· Check-in 15h / Check-out 11h</span></div>
          <div class="recap-conditions"><span class="amenity-yes">âœ“ Annulation gratuite avant 8 jan.</span><span class="amenity-yes">âœ“ Petit-dÃ©jeuner inclus</span></div>
        </div>

        <div class="recap-card">
          <div class="recap-card-header">
            <div class="recap-card-title">ğŸ’° Total</div>
          </div>
          <div class="recap-row"><span>Transport (3 voyageurs)</span><span id="recap-t-price">290 â‚¬</span></div>
          <div class="recap-row"><span>HÃ´tel (7 nuits)</span><span id="recap-h-price">742 â‚¬</span></div>
          <div class="recap-row total"><span>Total voyage</span><span id="recap-total">1 032 â‚¬</span></div>
          <div style="margin-top:8px;font-size:11px;color:var(--text-muted)">Budget max : 1 530 â‚¬ Â· Restant : 498 â‚¬</div>
          <div style="margin-top:4px;font-size:11px;color:var(--text-subtitle)">ğŸŒ¿ Total CO2 : 2,4 kg</div>
        </div>

        <div class="recap-cta">
          <button class="btn-primary" onclick="goToStep('confirmation')">Confirmer la rÃ©servation â†’</button>
        </div>
      </div>
    </div>
  </div>

  <!-- ================================================ -->
  <!-- STEP 4: CONFIRMATION (offer page)               -->
  <!-- ================================================ -->
  <div class="step-content" id="step-confirmation">
    <div class="step-inner" style="max-width:700px;margin:0 auto">
      <div style="text-align:center;padding:40px 0 24px">
        <div style="font-size:48px;margin-bottom:16px">âœ…</div>
        <div style="font-size:22px;font-weight:700;color:var(--text-primary);margin-bottom:8px">RÃ©servation confirmÃ©e</div>
        <div style="font-size:13px;color:var(--text-subtitle)">RÃ©fÃ©rence : <strong>FJ-2025-048392</strong></div>
        <div style="font-size:12px;color:var(--text-muted);margin-top:4px">Un e-mail de confirmation a Ã©tÃ© envoyÃ© Ã  l'ensemble des voyageurs.</div>
      </div>

      <div class="recap-card">
        <div class="recap-card-header"><div class="recap-card-title">ğŸ“‹ RÃ©capitulatif</div></div>
        <div class="recap-row"><span>ğŸš„ TGV INOUI Â· 2nde Classe</span><span>290 â‚¬</span></div>
        <div class="recap-row sub"><span>Aller : Ven. 16 jan. 07:13 â†’ 09:13 Â· Retour : Ven. 23 jan. 18:00 â†’ 20:00</span></div>
        <div class="recap-row" style="margin-top:8px"><span>ğŸ¨ Mercure Lyon Centre Â· Standard Double</span><span>742 â‚¬</span></div>
        <div class="recap-row sub"><span>7 nuits Â· 106 â‚¬/nuit Â· Check-in 15h / Check-out 11h</span></div>
        <div class="recap-row total" style="margin-top:12px"><span>Total voyage</span><span>1 032 â‚¬</span></div>
      </div>

      <div class="recap-card">
        <div class="recap-card-header"><div class="recap-card-title">ğŸ‘¤ Voyageurs</div></div>
        <div class="recap-row"><span>1. Marie Dupont (organisateur)</span><span>marie.dupont@acme.fr</span></div>
        <div class="recap-row"><span>2. Jean Martin</span><span>jean.martin@acme.fr</span></div>
        <div class="recap-row"><span>3. Sophie Bernard</span><span>sophie.bernard@acme.fr</span></div>
      </div>

      <div class="recap-card">
        <div class="recap-card-header"><div class="recap-card-title">ğŸ“„ Documents</div></div>
        <div style="display:flex;flex-direction:column;gap:8px;padding:4px 0">
          <div style="display:flex;align-items:center;gap:8px;font-size:12px"><span style="color:var(--text-tag-info)">ğŸ“¥</span> <a href="#" onclick="return false" style="color:var(--text-tag-info);text-decoration:underline">E-billets SNCF (3 voyageurs)</a></div>
          <div style="display:flex;align-items:center;gap:8px;font-size:12px"><span style="color:var(--text-tag-info)">ğŸ“¥</span> <a href="#" onclick="return false" style="color:var(--text-tag-info);text-decoration:underline">Confirmation hÃ´tel Mercure</a></div>
          <div style="display:flex;align-items:center;gap:8px;font-size:12px"><span style="color:var(--text-tag-info)">ğŸ“¥</span> <a href="#" onclick="return false" style="color:var(--text-tag-info);text-decoration:underline">Facture proforma</a></div>
        </div>
      </div>

      <div style="text-align:center;padding:24px 0">
        <button class="btn-primary" onclick="alert('Retour au dashboard')">Retour au tableau de bord â†’</button>
        <div style="margin-top:12px;font-size:11px;color:var(--text-muted)">Besoin de modifier ? Contactez votre travel manager ou utilisez le self-service dans "Mes voyages".</div>
      </div>
    </div>
  </div>

</div><!-- /main -->

<!-- ================================================ -->
<!-- DRAWER (shared â€” slides in from right)           -->
<!-- ================================================ -->
<div class="drawer-overlay" id="drawer-overlay" onclick="closeDrawer()"></div>
<div class="detail-drawer" id="detail-drawer">
  <div class="drawer-header">
    <div class="drawer-title" id="drawer-title">DÃ©tail</div>
    <button class="drawer-close" onclick="closeDrawer()">âœ•</button>
  </div>
  <div class="drawer-body" id="drawer-body">
    <!-- Panels are injected/toggled by JS -->
  </div>
</div>

<!-- RECO CTA BAR (fixed bottom, shown when reco detail is open) -->
<div class="d-reco-cta-bar" id="reco-cta-bar">
  <div class="rcb-summary" id="rcb-summary"></div>
  <button class="btn-primary" id="rcb-btn" onclick="selectRecoFromBar()">SÃ©lectionner ce transport â†’</button>
</div>

<!-- SELECTION FOOTER -->
<div class="selection-footer" id="selection-footer">
  <div class="sf-selection">
    <div class="sf-check">âœ“</div>
    <div>
      <div class="sf-name" id="sf-name">TGV INOUI</div>
      <div class="sf-price" id="sf-price">290 â‚¬</div>
    </div>
  </div>
  <div class="sf-actions">
    <button class="btn-secondary" onclick="openDrawer(currentSelection.id)">Modifier</button>
    <button class="btn-primary" id="sf-continue" onclick="continueToNext()">Continuer â†’</button>
  </div>
</div>


<script src="v1-app.js"></script>
</body>
</html>
